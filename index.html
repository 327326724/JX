<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8" />
<title>Jx</title>
<link href="css/main_new.css" rel="stylesheet" />
<script src="http://code.jquery.com/jquery.min.js"></script>

</head>

<body>
<div id="doc" class="doc full">
	<div class="nav">
		<h1 class="nav-title"></h1>
		<ul id="nav-ul" class="nav-ul">
			<li data-key="home" class="selected"><span>Home</span></li>
			<li data-key="docs"><a href="https://github.com/AlloyTeam/JX/wiki" target="_blank">Docs</a></li>
			<li data-key="demos"><span>Demos</span></li>
			<li data-key="jxui"><span>Jx UI</span></li>
			<li data-key="downloads"><span>Downloads</span></li>
			<li data-key="about"><span>About</span></li>
		</ul>
	</div>
	
	<div id="content" class="content">
		<iframe id="ifm" class="opa0" style="background-color: transparent; border: 0px;" frameborder="0" width="100%" height="100%" allowTransparency="true" src="about:blank"></iframe>
	</div>
</div>

<script>
$(function () {

	var urlHash = {
		'home': supportCanvas() ? 'frames/home.html' : 'frames/home_nocanvas.html',
		'docs': null,
		'demos': 'frames/demos.html',
		'jxui': 'frames/jxui.html',
		'downloads': 'frames/downloads.html',
		'about': 'frames/about.html'
	},
		$ifm = $('#ifm'),
		$navUl = $('#nav-ul'),
		$navLis = $('#nav-ul li');
		
	function resize () {
		$('.full').css({'minHeight': Math.max($(window).height(), 400)});
		fixIframeHeight();
	}
	function navItemClick (e) {
		var url = typeof e == 'string' ? urlHash[e] : $(this).attr('data-url');
		if ($(this).hasClass('selected')) {  
			return;
		}
		if (!!url) {
			$('#ifm').attr({src : url}).css({opacity: 0})
		}
		if (typeof e !== 'string') {
			$navUl.find('.selected').removeClass('selected');
			$(this).addClass('selected');
		}
		
	}
	function supportCanvas () {
		var canvas = document.createElement('canvas');
		return !!canvas.getContext;
	}
	function fixIframeHeight () {
		var ifm = $ifm.get(0);
		ifm.height = $(window).height();
		/*if (ifm.contentDocument && ifm.contentDocument.body.offsetHeight){
			ifm.height = ifm.contentDocument.body.offsetHeight;
		}else if(ifm.Document && ifm.Document.body.scrollHeight){
			ifm.height = ifm.Document.body.scrollHeight;
		}*/
	}
	
	resize();
	
	// main 
	function $init () {
		$setDataUrl();
		$bind();
		navItemClick('home');
	}
	function $bind() {
		$(window).resize(resize);
		$ifm.load(function () {
			$(this).animate({'opacity':1});
			resize();
		});
		$navLis.click(navItemClick)
	}
	function $setDataUrl () {
		$navLis.each(function () {
			var key = $(this).attr('data-key');
			if (!!urlHash[key]) {
				$(this).attr('data-url', urlHash[key]);
			}
		})
	}
	
	$init();
})
</script>
</body>
</html>